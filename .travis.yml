language: generic

matrix:
  include:
      - env: RUNTIME=2.7 ETS_TOOLKIT=qt QT_API=pyqt
      - env: RUNTIME=2.7 ETS_TOOLKIT=qt QT_API=pyside
      - env: RUNTIME=3.5 ETS_TOOLKIT=qt QT_API=pyqt
      - env: RUNTIME=3.6 ETS_TOOLKIT=qt QT_API=pyqt
      - os: osx
        env: RUNTIME=2.7 ETS_TOOLKIT=qt QT_API=pyqt
      - os: osx
        env: RUNTIME=2.7 ETS_TOOLKIT=qt QT_API=pyside
      - os: osx
        env: RUNTIME=3.5 ETS_TOOLKIT=qt QT_API=pyqt
      - os: osx
        env: RUNTIME=3.6 ETS_TOOLKIT=qt QT_API=pyqt

cache:
  pip: true
  directories:
    - $HOME/.ccache

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi
  - export DISPLAY=:99.0
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sh -e /etc/init.d/xvfb start; fi
  - ./travis_ci_bootstrap_edm.sh
  - edm environments create python${RUNTIME} --version ${RUNTIME}
install:
  - edm install -e python${RUNTIME} -y future networkx traits traitsui enable numpy pillow mock haas coverage ${QT_API}
  # FIXME: pygraphviz should be installed for complete testing
  - edm run -e python${RUNTIME} -- pip install git+http://github.com/nucleic/kiwi.git#egg=kiwisolver
  - edm run -e python${RUNTIME} -- python setup.py develop
script:
  - edm run -e python${RUNTIME} -- coverage run -m haas -v
after_success:
  - edm run -e python${RUNTIME} -- coverage report
